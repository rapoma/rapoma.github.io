<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Basic implementation of an Elliptic Curve in C++" /><meta name="author" content="Rapoma" /><meta property="og:locale" content="en_US" /><meta name="description" content="A short anecdote, I once participated in a cryptography challenge, in which most of the questions were breaking ECDH. There are many tools out there but my problem is that instead of using it, I ended up learning to use it. What I mean is that, let say I want to factorize a number and the tool uses brute force to find factor but if I already knew some sets that wont divide the number, of course I would skip them but the tools did not give me that freedom." /><meta property="og:description" content="A short anecdote, I once participated in a cryptography challenge, in which most of the questions were breaking ECDH. There are many tools out there but my problem is that instead of using it, I ended up learning to use it. What I mean is that, let say I want to factorize a number and the tool uses brute force to find factor but if I already knew some sets that wont divide the number, of course I would skip them but the tools did not give me that freedom." /><link rel="canonical" href="https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" /><meta property="og:url" content="https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" /><meta property="og:site_name" content="Nantenaina Andrianaivo Louis" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-03T17:14:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Basic implementation of an Elliptic Curve in C++" /><meta name="twitter:site" content="@NantenainaLouis" /><meta name="twitter:creator" content="@Rapoma" /><meta name="google-site-verification" content="npPpZ0vbnNYVVMapmzedXjduRrKG-1-750bjKRVkjCc" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Rapoma"},"description":"A short anecdote, I once participated in a cryptography challenge, in which most of the questions were breaking ECDH. There are many tools out there but my problem is that instead of using it, I ended up learning to use it. What I mean is that, let say I want to factorize a number and the tool uses brute force to find factor but if I already knew some sets that wont divide the number, of course I would skip them but the tools did not give me that freedom.","url":"https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/","@type":"BlogPosting","headline":"Basic implementation of an Elliptic Curve in C++","dateModified":"2021-03-03T17:14:00+01:00","datePublished":"2021-03-03T17:14:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/"},"@context":"https://schema.org"}</script><title>Basic implementation of an Elliptic Curve in C++ | Nantenaina Andrianaivo Louis</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nantenaina Andrianaivo Louis</a></div><div class="site-subtitle font-italic">People :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rapoma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/nantenaina-louis-andrianaivo-916b4815b" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['landrianaivo740','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Basic implementation of an Elliptic Curve in C++</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Basic implementation of an Elliptic Curve in C++</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 3, 2021, 5:14 PM +0100" > Mar 3 <i class="unloaded">2021-03-03T17:14:00+01:00</i> </span> by <span class="author"> Rapoma </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2242 words">12 min</span></div></div><div class="post-content"><blockquote><p>A short anecdote, I once participated in a cryptography challenge, in which most of the questions were breaking <a href="https://wiki.openssl.org/index.php/Elliptic_Curve_Diffie_Hellman">ECDH</a>. There are many tools out there but my problem is that instead of using it, I ended up learning to use it. What I mean is that, let say I want to factorize a number and the tool uses brute force to find factor but if I already knew some sets that wont divide the number, of course I would skip them but the tools did not give me that freedom.</p></blockquote><h2 id="introduction">Introduction</h2><p>In this post, I am going to share a <em>very basic</em> implementation of an Elliptic Curve over a finite field in <a href="https://en.wikipedia.org/wiki/C%2B%2B"><em>C++</em></a>. Using a library for arithmetic and algebraic computation <a href="https://casys.gricad-pages.univ-grenoble-alpes.fr/givaro/">Givaro</a>, this is one of the back-end of <a href="https://www.sagemath.org/">Sagemath</a>.</p><p>I consider the reduced Weierstrass form (field I am going to use is of characteristic different from 2 and 3).</p>\[y^2 =x^3+Ax+ B\]<p>To follow along, you might need a basic understanding of <code class="language-plaintext highlighter-rouge">C++</code> and how to use makefile, also I assume that you know what an Elliptic Curve is. In this post I consider an elliptic curve over a finite field which is actually a group. For not going so deep, just consider it as a set of rational point. Also I am going to use affine coordinates representation, of course one can tweak the code to use projective coordinates depending on what is your need, in here lets just keep it simple.</p><h2 id="steps">Steps</h2><h3 id="getting-started">Getting started</h3><p>To install Givaro, you could use the instruction <a href="https://casys.gricad-pages.univ-grenoble-alpes.fr/givaro/givaro_install.html">here</a>, this is the first requirement. To confirm the installation, grab one of the examples in the source code.</p><p>Take a 10 second to breath ðŸ˜Ž. What do we need? good question.</p><ul><li>Curve : Field and coefficients $A$ and $B$.<li><p>Point : Only the element We then implement the operation on the Elliptic Curve.</p><li><p>Few theory to refresh our memory about the group operation. \(K\) be a field of char \(\neq 2,3\)</p><p>Let \(P(x_1,y_1)\), \(Q(x_2,y_2)\) points of \(E(\mathbb{K})\) and \(\mathcal{O}\) the identity.</p><ul><li>Inverse of \(P\) is \(-P\) of coordinate \((x_1, -y_1)\)<li>Addition</ul><p>case 1: \(P = -Q\) ==&gt; \(\mathcal{O}\)</p><p>case 2: \(P = Q\)</p><p>the slope of the tangent line at \(P\) is \(m = \frac{3x_1^2 + A}{2y_1}\)</p><p>so if \(R(x_3,y_3) = P + Q\) then we have</p>\[x_3 = m^2 - 2x_1\] \[y_3 = m(x_1 - x_3) - y_1\]<p>case 3: \(P \neq Q\)</p><p>the slope of the line pass through \(PQ\) is \(m = \frac{y_2 - y_1}{x_2 - x_1}\)</p><p>so if \(R(x_3,y_3) = P + Q\) then we have</p>\[x_3 = m^2 - (x_1 + x_2)\] \[y_3 = m(x_1 - x_3) - y_1\]</ul><h3 id="setup">Setup</h3><p>I organize the development setup as follow.</p><p>Choose any directory to work in, mine I call it <code class="language-plaintext highlighter-rouge">Ecc</code>, inside make two directories <code class="language-plaintext highlighter-rouge">include</code> and <code class="language-plaintext highlighter-rouge">src</code>, and a <code class="language-plaintext highlighter-rouge">Makefile</code> to make our life easy ðŸ˜Ž and code like a boss.</p><p>In the first place, I create a common header, name it <code class="language-plaintext highlighter-rouge">common.h</code> inside <code class="language-plaintext highlighter-rouge">include</code>. Here is the content</p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cp">#include &lt;stdlib.h&gt;
#include &lt;givaro/modular-integer.h&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">Givaro</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">Modular</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ZP</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">ZP</span><span class="o">::</span><span class="n">Element</span> <span class="n">Element</span><span class="p">;</span>
</pre></table></code></div></div><p>Leave it like this for now, we can update it later on if needed. Of course, what are they? we are going to use <em>modular-integer</em>, for further information, please see the Givaro <a href="https://casys.gricad-pages.univ-grenoble-alpes.fr/givaro/">documentation</a>. The new type are just the <em>Integer Modulo</em> \(Z_n\) and its element.</p><p>Now we are ready to code the project.</p><h3 id="point">Point</h3><p>Implementation of rational point (affine) <code class="language-plaintext highlighter-rouge">Point.h</code>.</p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="cp">#ifndef POINT_H_
#define POINT_H_
</span>
<span class="k">class</span> <span class="nc">Point</span>
<span class="p">{</span>
<span class="nl">private:</span>
    
    <span class="kt">bool</span> <span class="n">identity</span><span class="p">;</span>
    <span class="n">Element</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
<span class="nl">public:</span>

    <span class="n">Point</span><span class="p">()</span> <span class="o">:</span> <span class="n">identity</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{}</span>
    <span class="n">Point</span><span class="p">(</span><span class="kt">bool</span> <span class="n">b</span><span class="p">);</span>
    <span class="n">Point</span><span class="p">(</span><span class="n">Element</span> <span class="n">x</span><span class="p">,</span> <span class="n">Element</span> <span class="n">y</span><span class="p">);</span>
    <span class="n">Element</span> <span class="n">getX</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kt">void</span> <span class="n">setX</span><span class="p">(</span><span class="n">Element</span> <span class="n">_x</span><span class="p">){</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">_x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">Element</span> <span class="n">getY</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kt">void</span> <span class="n">setY</span><span class="p">(</span><span class="n">Element</span> <span class="n">_y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">=</span> <span class="n">_y</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kt">bool</span> <span class="n">isIdentity</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kt">void</span> <span class="n">setIdentity</span><span class="p">(</span><span class="kt">bool</span> <span class="n">_identity</span><span class="p">){</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">=</span> <span class="n">_identity</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">Point</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">);</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">print</span><span class="p">();</span>
<span class="p">};</span>

<span class="cp">#endif
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Point.cpp</code> inside <code class="language-plaintext highlighter-rouge">src</code></p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="cp">#include "common.h"
#include "Point.h"
</span>
<span class="n">Point</span><span class="o">::</span><span class="n">Point</span><span class="p">(</span><span class="kt">bool</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>


<span class="n">Point</span><span class="o">::</span><span class="n">Point</span><span class="p">(</span><span class="n">Element</span> <span class="n">x</span><span class="p">,</span> <span class="n">Element</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span><span class="n">identity</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>


<span class="n">Point</span> <span class="n">Point</span><span class="o">::</span><span class="k">operator</span> <span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">identity</span><span class="p">)</span>
	    <span class="p">{</span>
	    <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
	    <span class="p">}</span>

	    <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span><span class="o">=</span><span class="n">P</span><span class="p">.</span><span class="n">identity</span><span class="p">;</span>
	    <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	    <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">bool</span> <span class="n">Point</span><span class="o">::</span><span class="k">operator</span> <span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">&amp;&amp;</span> <span class="n">P</span><span class="p">.</span><span class="n">identity</span><span class="p">)</span> <span class="o">||</span>
	                        <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">P</span><span class="p">.</span><span class="n">identity</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">==</span> <span class="n">P</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">==</span> <span class="n">P</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">Point</span><span class="o">::</span><span class="n">print</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span> <span class="o">?</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"infinity "</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">:</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"["</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">","</span>
	<span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="s">"]"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="curve">Curve</h3><p>Representation of the curve, <code class="language-plaintext highlighter-rouge">Curve.h</code></p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="cp">#ifndef CURVE_H_
#define CURVE_H_
</span><span class="k">class</span> <span class="nc">Curve</span>
    <span class="p">{</span>
    <span class="nl">private:</span>
        <span class="n">ZP</span><span class="o">*</span> <span class="n">FField</span><span class="p">;</span>
        <span class="n">Element</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">;</span>

    <span class="nl">public:</span>
        <span class="n">Curve</span><span class="p">();</span>
        <span class="n">Curve</span><span class="p">(</span><span class="n">Integer</span> <span class="n">primeField</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">A</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">B</span><span class="p">);</span>
        <span class="o">~</span><span class="n">Curve</span><span class="p">();</span>
        <span class="kt">bool</span> <span class="n">isZeroDiscriminant</span><span class="p">();</span>
        <span class="n">ZP</span> <span class="o">*</span><span class="n">getField</span><span class="p">()</span>
            <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="p">;</span>
            <span class="p">};</span>

        <span class="n">Element</span> <span class="n">getA</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="n">Element</span> <span class="n">getB</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="kt">void</span> <span class="n">print</span><span class="p">();</span> 
    <span class="p">};</span>

<span class="cp">#endif
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Curve.cpp</code> inside <code class="language-plaintext highlighter-rouge">src</code></p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="cp">#include "common.h"
#include "Curve.h"
</span>
<span class="n">Curve</span><span class="o">::</span><span class="n">Curve</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">Integer</span> <span class="n">p</span><span class="p">;</span>
	<span class="k">do</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="s">"Enter the Prime modulo p :"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">;</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ZP</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Enter A : "</span><span class="p">;</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">read</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Enter B : "</span><span class="p">;</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">read</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">isZeroDiscriminant</span><span class="p">());</span>
	<span class="p">}</span>


<span class="n">Curve</span><span class="o">::~</span><span class="n">Curve</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">free</span><span class="p">(</span><span class="n">FField</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Curve</span><span class="o">::</span><span class="n">Curve</span><span class="p">(</span><span class="n">Integer</span> <span class="n">primeField</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">A</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">B</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ZP</span><span class="p">(</span><span class="n">primeField</span><span class="p">);</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">,</span><span class="n">B</span><span class="p">);</span> 

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">isZeroDiscriminant</span><span class="p">()){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"[!] Curve not defined, disriminant is Zero"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"[+ INFO ] Field : Z/"</span> <span class="o">&lt;&lt;</span> <span class="n">primeField</span> <span class="o">&lt;&lt;</span> <span class="s">"Z"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"[+ INFO ] A : "</span> <span class="o">&lt;&lt;</span> <span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="s">" ; B : "</span> <span class="o">&lt;&lt;</span> <span class="n">B</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
        <span class="n">abort</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="kt">void</span> <span class="n">Curve</span><span class="o">::</span><span class="n">print</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" Field : Z/"</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">residu</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"Z"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" A :"</span> <span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">", B :"</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Curve</span><span class="o">::</span><span class="n">isZeroDiscriminant</span><span class="p">(){</span>
    <span class="n">Element</span> <span class="n">Acube</span><span class="p">,</span> <span class="n">Bsquare</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">Acube</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">Acube</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">Acube</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="s">"4"</span><span class="p">));</span>

    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">Bsquare</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">Bsquare</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="s">"27"</span><span class="p">));</span>

    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">addin</span><span class="p">(</span><span class="n">Acube</span><span class="p">,</span> <span class="n">Bsquare</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">isZero</span><span class="p">(</span><span class="n">Acube</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>I just thought that its funnier to have the check of non-singularity in here.</p><h3 id="elliptic-curve">Elliptic Curve</h3><p>Elliptic Curve <code class="language-plaintext highlighter-rouge">EllipticCurve.h</code></p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="cp">#ifndef ELLIPTICCURVE_H_
#define ELLIPTICCURVE_H_
</span><span class="k">class</span> <span class="nc">EllipticCurve</span>
<span class="p">{</span>
<span class="nl">private:</span>
    <span class="k">typedef</span> <span class="n">ZP</span><span class="o">::</span><span class="n">Element</span> <span class="n">Element</span><span class="p">;</span>
    <span class="n">Curve</span> <span class="o">*</span><span class="n">curve</span><span class="p">;</span>
    <span class="n">ZP</span> <span class="o">*</span><span class="n">FField</span><span class="p">;</span>
    <span class="n">Point</span> <span class="n">identity</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Curve</span> <span class="o">*</span><span class="n">c</span><span class="p">);</span>
    <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Integer</span> <span class="n">primeField</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">A</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">B</span><span class="p">);</span>
    <span class="o">~</span><span class="n">EllipticCurve</span><span class="p">();</span>

    <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">_inv</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">Q</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">);</span>
    <span class="kt">bool</span> <span class="n">_isInv</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">Q</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">);</span>
    <span class="n">Point</span><span class="o">&amp;</span> <span class="n">_double</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">);</span>
    <span class="n">Point</span><span class="o">&amp;</span> <span class="n">_add</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span><span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">P</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">Q</span><span class="p">);</span>
    <span class="n">Point</span><span class="o">&amp;</span> <span class="n">_scalar</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">,</span><span class="n">Integer</span> <span class="n">k</span><span class="p">);</span>

    <span class="kt">bool</span> <span class="n">verifyPoint</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
    <span class="kt">void</span> <span class="n">print</span><span class="p">();</span>

<span class="p">};</span>
<span class="cp">#endif
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">EllipticCurve.cpp</code> inside <code class="language-plaintext highlighter-rouge">src</code></p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
</pre><td class="rouge-code"><pre><span class="cp">#include "common.h"
#include "Point.h"
#include "Curve.h"
#include "EllipticCurve.h"
</span>
<span class="n">EllipticCurve</span><span class="o">::</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Integer</span> <span class="n">primeField</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">A</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">B</span><span class="p">)</span>
    <span class="p">{</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Curve</span><span class="p">(</span><span class="n">primeField</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getField</span><span class="p">();</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>


<span class="n">EllipticCurve</span><span class="o">::</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Curve</span><span class="o">*</span> <span class="n">curve</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span> <span class="o">=</span> <span class="n">curve</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getField</span><span class="p">();</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">identity</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	<span class="p">}</span>

<span class="n">EllipticCurve</span><span class="o">::~</span><span class="n">EllipticCurve</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">free</span><span class="p">(</span><span class="n">curve</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">FField</span><span class="p">);</span>
	<span class="p">}</span>


<span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">_inv</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">Q</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="n">Q</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">Q</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span>
	<span class="p">{</span>
		<span class="n">Q</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
		<span class="n">Q</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
        <span class="n">Element</span> <span class="n">tmp</span><span class="p">;</span>
		<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">zero</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">());</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">Q</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="p">}</span>



<span class="n">Point</span><span class="o">&amp;</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">_double</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Point</span> <span class="n">tmp</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">_inv</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">P</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">()</span> <span class="o">||</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">==</span> <span class="n">P</span><span class="p">))</span>
	    <span class="p">{</span>
	    <span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="k">else</span>
		<span class="p">{</span>
		<span class="c1">//</span>
		<span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
		<span class="n">Element</span> <span class="n">tmp</span><span class="p">;</span>
		<span class="n">Element</span> <span class="n">xs</span><span class="p">;</span> <span class="c1">// 3*x^2</span>
		<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
		<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">tmp</span><span class="p">,(</span><span class="kt">uint64_t</span><span class="p">)</span><span class="mi">3</span><span class="p">);</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">tmp</span><span class="p">);</span>
        <span class="c1">//</span>
		<span class="n">Element</span> <span class="n">ty</span><span class="p">;</span> <span class="c1">// 2*y</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">tmp</span><span class="p">,(</span><span class="kt">uint64_t</span><span class="p">)</span><span class="mi">2</span><span class="p">);</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">(),</span><span class="n">tmp</span><span class="p">);</span>
		<span class="c1">//</span>
		<span class="n">Element</span> <span class="n">slope</span><span class="p">;</span> <span class="c1">// m</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">xs</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">());</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">div</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="n">ty</span><span class="p">);</span>
		<span class="c1">//</span>
		<span class="n">Element</span> <span class="n">slope2</span><span class="p">;</span> <span class="c1">// m^2</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">slope2</span><span class="p">,</span><span class="n">slope</span><span class="p">,</span><span class="n">slope</span><span class="p">);</span>
		<span class="c1">//</span>
		<span class="n">Element</span> <span class="n">tx</span><span class="p">;</span> <span class="c1">// 2x</span>
		<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
        <span class="c1">//</span>
		<span class="n">Element</span> <span class="n">x3</span><span class="p">;</span> <span class="c1">// x_3</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">slope2</span><span class="p">,</span><span class="n">tx</span><span class="p">);</span>
		<span class="c1">//</span>
		<span class="n">Element</span> <span class="n">y3</span><span class="p">;</span> <span class="c1">// y_3</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">x3</span><span class="p">);</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">slope</span><span class="p">),</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">());</span>

        <span class="n">R</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span><span class="n">x3</span><span class="p">);</span>
        <span class="n">R</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span><span class="n">y3</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>


<span class="n">Point</span><span class="o">&amp;</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">_add</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">Q</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Point</span> <span class="n">tmp1</span><span class="p">,</span> <span class="n">tmp2</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">_inv</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">_inv</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span> <span class="n">Q</span><span class="p">);</span>
	<span class="k">if</span><span class="p">((</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">Q</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span> <span class="o">||</span> <span class="p">(</span><span class="n">tmp1</span> <span class="o">==</span> <span class="n">Q</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">tmp2</span> <span class="o">==</span> <span class="n">P</span><span class="p">))</span>
		<span class="p">{</span>
	    <span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span>
	    <span class="p">{</span>
	    <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="p">;</span>
	    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Q</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span>
	    <span class="p">{</span>
	    <span class="n">R</span> <span class="o">=</span> <span class="n">P</span><span class="p">;</span>
	    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="o">==</span><span class="n">Q</span><span class="p">)</span>
	   <span class="p">{</span>
		<span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">_double</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">P</span><span class="p">);</span>
	   <span class="p">}</span>
	<span class="c1">//</span>
    <span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">Element</span> <span class="n">tmp</span><span class="p">;</span>
	<span class="n">Element</span> <span class="n">num</span><span class="p">;</span> <span class="c1">// y2 - y1</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">Q</span><span class="p">.</span><span class="n">getY</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">());</span>
	<span class="c1">//</span>
	<span class="n">Element</span> <span class="n">den</span><span class="p">;</span> <span class="c1">// x2 - x1</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">den</span><span class="p">,</span><span class="n">Q</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
	<span class="c1">//</span>
	<span class="n">Element</span> <span class="n">slope</span><span class="p">;</span> <span class="c1">// m</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">div</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">);</span>
	<span class="c1">//</span>
	<span class="n">Element</span> <span class="n">slope2</span><span class="p">;</span> <span class="c1">// m^2</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">slope2</span><span class="p">,</span><span class="n">slope</span><span class="p">,</span><span class="n">slope</span><span class="p">);</span>
	<span class="c1">// </span>
	<span class="n">Element</span> <span class="n">x3</span><span class="p">;</span> <span class="c1">// x_3</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">slope2</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">Q</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">()));</span>
	<span class="c1">//</span>
	<span class="n">Element</span> <span class="n">diffx3</span><span class="p">;</span> <span class="c1">// x_1 - x_3</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">diffx3</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">x3</span><span class="p">);</span>
	<span class="c1">//</span>
	<span class="n">Element</span> <span class="n">y3</span><span class="p">;</span> <span class="c1">// y_3</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">slope</span><span class="p">,</span><span class="n">diffx3</span><span class="p">);</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">sub</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">());</span>
	
    <span class="n">R</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span><span class="n">x3</span><span class="p">);</span>
    <span class="n">R</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span><span class="n">y3</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	<span class="p">}</span>


<span class="n">Point</span><span class="o">&amp;</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">_scalar</span><span class="p">(</span><span class="n">Point</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Point</span> <span class="n">tmp1</span><span class="p">,</span> <span class="n">tmp2</span><span class="p">;</span>
	<span class="n">R</span><span class="p">.</span><span class="n">setIdentity</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
	<span class="n">Point</span> <span class="n">PP</span> <span class="o">=</span> <span class="n">P</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	    <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
			<span class="k">this</span><span class="o">-&gt;</span><span class="n">_add</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">PP</span><span class="p">);</span>
			<span class="n">R</span> <span class="o">=</span> <span class="n">tmp1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="n">tmp2</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">_double</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="n">PP</span><span class="p">);</span>
		<span class="n">PP</span> <span class="o">=</span> <span class="n">tmp2</span><span class="p">;</span>
		<span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="k">return</span> <span class="n">R</span><span class="p">;</span>
	<span class="p">}</span>


<span class="kt">bool</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">verifyPoint</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">isIdentity</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Element</span> <span class="n">x3</span><span class="p">,</span><span class="n">y2</span><span class="p">;</span>
	<span class="n">Element</span> <span class="n">Ax</span><span class="p">,</span><span class="n">rhs</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mulin</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">());</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">Ax</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getX</span><span class="p">(),</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">());</span>
    
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">Ax</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">addin</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getB</span><span class="p">());</span>

   
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">mul</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">getY</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">y2</span><span class="o">==</span><span class="n">rhs</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">EllipticCurve</span><span class="o">::</span><span class="n">print</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"Elliptic Curve Defined by "</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"y^2 = x^3 + "</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">());</span>
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"x + "</span><span class="p">;</span>
	<span class="k">this</span><span class="o">-&gt;</span><span class="n">FField</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">curve</span><span class="o">-&gt;</span><span class="n">getB</span><span class="p">());</span>
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
	<span class="c1">//std::cout &lt;&lt; this-&gt;FField-&gt;Modular_implem() &lt;&lt; std::endl;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now we are ready to test the code. create another file where we add the main, I call mine <code class="language-plaintext highlighter-rouge">test.cpp</code> with the following content</p><div class="language-c++ highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="cp">#include &lt;iostream&gt;
</span>
<span class="cp">#include "common.h"
#include "Point.h"
#include "Curve.h"
#include "EllipticCurve.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">Givaro</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="cm">/**
    ** y^2 = x^3 + 7 
    **/</span>
    <span class="n">EllipticCurve</span> <span class="n">ecc</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="s">"115792089237316195423570985008687907853269984665640564039457584007908834671663"</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="s">"0"</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="s">"7"</span><span class="p">));</span>

    <span class="n">ecc</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

    <span class="n">Point</span> <span class="n">P</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="s">"65485170049033141755572552932091555440395722142984193594072873483228125624049"</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="s">"73163377763031141032501259779738441094247887834941211187427503803434828368457"</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ecc</span><span class="p">.</span><span class="n">verifyPoint</span><span class="p">(</span><span class="n">P</span><span class="p">)){</span>
        <span class="n">P</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Point : verified!!!!"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">Point</span> <span class="n">P2</span><span class="p">;</span>
    <span class="n">ecc</span><span class="p">.</span><span class="n">_inv</span><span class="p">(</span><span class="n">P2</span><span class="p">,</span><span class="n">P</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ecc</span><span class="p">.</span><span class="n">verifyPoint</span><span class="p">(</span><span class="n">P2</span><span class="p">)){</span>
        <span class="n">P2</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Inverse : verified"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">Point</span> <span class="n">R</span><span class="p">;</span> 
    <span class="n">R</span> <span class="o">=</span> <span class="n">ecc</span><span class="p">.</span><span class="n">_double</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ecc</span><span class="p">.</span><span class="n">verifyPoint</span><span class="p">(</span><span class="n">R</span><span class="p">)){</span>
        <span class="n">R</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"double : verified"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">Point</span> <span class="n">Rp</span> <span class="p">;</span>
    <span class="n">Rp</span> <span class="o">=</span> <span class="n">ecc</span><span class="p">.</span><span class="n">_add</span><span class="p">(</span><span class="n">Rp</span><span class="p">,</span> <span class="n">P</span> <span class="p">,</span> <span class="n">P</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ecc</span><span class="p">.</span><span class="n">verifyPoint</span><span class="p">(</span><span class="n">Rp</span><span class="p">)){</span>
        <span class="n">Rp</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"add : verified"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">assert</span><span class="p">(</span><span class="n">Rp</span> <span class="o">==</span> <span class="n">R</span><span class="p">);</span>

    <span class="n">Point</span> <span class="n">R5</span><span class="p">;</span>
    <span class="n">R5</span> <span class="o">=</span> <span class="n">ecc</span><span class="p">.</span><span class="n">_scalar</span><span class="p">(</span><span class="n">R5</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="s">"13257"</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ecc</span><span class="p">.</span><span class="n">verifyPoint</span><span class="p">(</span><span class="n">R5</span><span class="p">)){</span>
        <span class="n">R5</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"scalar : verified"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>One last thing, letâ€™s create a simple makefile. This is totally optional, I just want to have a clean structure and easy workflow.</p><pre><code class="language-Makefile">######## please change me ########
GMPROOT   := $(HOME)/Developements/homebrew/Cellar/gmp/6.2.1
GIVAROROOT:= $(HOME)/Developements/Givaro
##################################

LDFLAGS   := -L$(GMPROOT)/lib -L$(GIVAROROOT)/lib
INCLUDES  := -I$(GMPROOT)/include -I$(GIVAROROOT)/include -Iinclude
LIBS 	  := -lgmp -lgivaro 

######## here you can use g++ ####
CXX       := clang++
CXXFLAGS  := -std=c++11 -O0 -g3 -Wall -fmessage-length=0


OBJ_DIR  := ./obj
BIN_DIR  := ./bin
TARGET   := main
SRC      := $(wildcard src/*.cpp)

OBJECTS  	 := $(SRC:%.cpp=$(OBJ_DIR)/%.o)
DEPENDENCIES := $(OBJECTS:.o=.d)

all: clean build $(BIN_DIR)/$(TARGET)

$(OBJ_DIR)/%.o: %.cpp
	@mkdir -p $(@D)
	$(CXX) $(CXXFLAGS) $(INCLUDES) -c $&lt; -MMD -o $@
	

$(BIN_DIR)/$(TARGET): $(OBJECTS)
	@mkdir -p $(@D)
	$(CXX) $(CXXFLAGS) -o $(BIN_DIR)/$(TARGET) $^ $(LDFLAGS) $(LIBS)

-include $(DEPENDENCIES)

.PHONY: all build clean run

build:
	@echo "[*] ðŸ›    Building           "
	@echo 
	@mkdir -p $(OBJ_DIR)
	@mkdir -p $(OBJ_DIR)

clean:
	@echo "[*] ðŸ§»ðŸ§»Â Cleaning           "
	@echo
	-@rm -rvf $(OBJ_DIR)/*
	-@rm -rvf $(BIN_DIR)/*

run: all
	@echo "[*] ðŸš€ Start Running       "
	@echo 
	$(BIN_DIR)/$(TARGET)
	@echo
	@echo "[*] Finish running         "
</code></pre><p>Now go to you terminal and hit <code class="language-plaintext highlighter-rouge">make run</code> you should see a very cool picture of yourself ðŸ˜‚. Well it should work smoothly. In case it doesnt, join me in the comment section. Also you can always check the <a href="https://github.com/rapoma/ecc-basis">gitrepo</a>.</p><h2 id="tips">Tips</h2><ol><li>Try more example for testing, use other tool to verify the result.<li>If you have any suggestion and need help to make it, just use the comment section.<li>Next step? I do not know yet.</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/math/'>Math</a>, <a href='/categories/ellipticcurve/'>EllipticCurve</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/elliptic-curve/" class="post-tag no-text-decoration" >Elliptic curve</a> <a href="/tags/c/" class="post-tag no-text-decoration" >C++</a> <a href="/tags/givaro/" class="post-tag no-text-decoration" >givaro</a> <a href="/tags/nathematics/" class="post-tag no-text-decoration" >nathematics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Basic implementation of an Elliptic Curve in C++ - Nantenaina Andrianaivo Louis&url=https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Basic implementation of an Elliptic Curve in C++ - Nantenaina Andrianaivo Louis&u=https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Basic implementation of an Elliptic Curve in C++ - Nantenaina Andrianaivo Louis&url=https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Sagemath-Development-Environment/">Sagemath development environment</a><li><a href="/posts/initial-commit/">Initial commit</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/arm64/">arm64</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/sharing/">sharing</a> <a class="post-tag" href="/tags/apple-m1/">apple-m1</a> <a class="post-tag" href="/tags/apple-silicon/">apple-silicon</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/elliptic-curve/">Elliptic curve</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/givaro/">givaro</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Sagemath-Development-Environment/"><div class="card-body"> <span class="timeago small" > Jan 29 <i class="unloaded">2021-01-29T02:21:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sagemath development environment</h3><div class="text-muted small"><p> Intro In this post, I share the steps I followed, by making a development environment for sage. There are no particular requirements to be able to follow along. I would recommend you to explore th...</p></div></div></a></div><div class="card"> <a href="/posts/initial-commit/"><div class="card-body"> <span class="timeago small" > Jan 27 <i class="unloaded">2021-01-27T21:10:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Initial commit</h3><div class="text-muted small"><p> Intro In this first post, I share the steps I followed, by making this personal website. There are no particular requirements to be able to follow along. I would recommend you to explore jekyll, a...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Sagemath-Development-Environment/" class="btn btn-outline-primary" prompt="Older"><p>Sagemath development environment</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted pb-5"> Loading comments from <a href="https://disqus.com/">Disqus</a> ...</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//rapoma-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Basic implementation of an Elliptic Curve in C++'; this.page.url = 'https://www.nantenaina.xyz/posts/basic-implementation-of-an-elliptic-curve-in-cpp/'; this.page.identifier = '/posts/basic-implementation-of-an-elliptic-curve-in-cpp/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://github.com/rapoma">nantenaina_louis</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/arm64/">arm64</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/sharing/">sharing</a> <a class="post-tag" href="/tags/apple-m1/">apple m1</a> <a class="post-tag" href="/tags/apple-silicon/">apple silicon</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/elliptic-curve/">Elliptic curve</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/givaro/">givaro</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.nantenaina.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
